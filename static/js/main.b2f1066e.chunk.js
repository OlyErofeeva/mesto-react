(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,a,t){e.exports=t(16)},15:function(e,a,t){},16:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(5),i=t.n(o),l=(t(15),t(9)),s=t(1),c=t(6),u=t.n(c);var m=function(){return r.a.createElement("header",{className:"header page__header"},r.a.createElement("img",{className:"header__logo",src:u.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto"}))};var d=function(){return r.a.createElement("div",{className:"loader-container"},r.a.createElement("div",{className:"loader"}))},f=r.a.createContext();var _=function(e){var a=e.name,t=e.link,n=e.likes,o=e.owner,i=e._id,l=e.onCardClick,s=e.onCardLike,c=e.onCardDelete,u=r.a.useContext(f),m=o._id===u._id,d="card__delete-button ".concat(m?"":"card__delete-button_hidden"),_=n.some((function(e){return e._id===u._id})),h="card__like-button ".concat(_?"card__like-button_active":"");return r.a.createElement("li",{className:"card"},r.a.createElement("div",{className:"card__photo-container"},r.a.createElement("img",{className:"card__photo",src:t,alt:a,onClick:function(){l({name:a,link:t})}})),r.a.createElement("div",{className:"card__info"},r.a.createElement("h2",{className:"card__caption"},a),r.a.createElement("div",{className:"card__like-container"},r.a.createElement("button",{className:h,type:"button",onClick:function(){s(n,i)}}),r.a.createElement("p",{className:"card__likes"},n.length))),r.a.createElement("button",{className:d,type:"button",onClick:function(){c(i)}}))};var h=function(e){var a=e.onEditProfile,t=e.onAddPlace,n=e.onEditAvatar,o=e.cards,i=e.onCardClick,l=e.onCardLike,s=e.onCardDelete,c=r.a.useContext(f);return r.a.createElement("main",{className:"content page__content"},r.a.createElement("section",{className:"profile page__profile"},r.a.createElement("div",{className:"profile__container"},r.a.createElement("div",{className:"profile__avatar-container",onClick:n},r.a.createElement("img",{className:"profile__avatar",src:c.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})),r.a.createElement("div",{className:"profile__flex-column"},r.a.createElement("div",{className:"profile__flex-row"},r.a.createElement("h1",{className:"profile__full-name"},c.name),r.a.createElement("button",{className:"profile__edit-button",type:"button",onClick:a})),r.a.createElement("p",{className:"profile__bio"},c.about))),r.a.createElement("button",{className:"add-button",type:"button",onClick:t})),r.a.createElement("section",{className:"gallery"},r.a.createElement("ul",{className:"cards-container"},o.map((function(e){return r.a.createElement(_,Object.assign({},e,{key:e._id,onCardClick:i,onCardLike:l,onCardDelete:s}))})))))};var v=function(){return r.a.createElement("footer",{className:"footer page__footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var p=function(e){var a=e.name,t=e.formTitle,n=e.submitButtonTitle,o=e.children,i=e.isOpen,l=e.onClose,s=e.onSubmit,c=e.isSubmitDisabled;return r.a.createElement("div",{className:"modal modal_for_".concat(a," ").concat(i?"modal_opened":"")},r.a.createElement("div",{className:"modal__content"},r.a.createElement("form",{className:"form",name:a,action:"#",noValidate:!0,onSubmit:s},r.a.createElement("h2",{className:"form__title"},t),o,r.a.createElement("button",{className:"form__submit-button \n              ".concat(c?"form__submit-button_disabled":"","\n            "),type:"submit",disabled:c},n)),r.a.createElement("button",{className:"modal__close-button",type:"button",onClick:l})))};var b=function(e){var a=e.isOpen,t=e.onClose,n=e.onUpdateUser,o=r.a.useContext(f),i=r.a.useState({value:"",errorMessage:"",isValid:!1}),l=Object(s.a)(i,2),c=l[0],u=l[1],m=r.a.useState({value:"",errorMessage:"",isValid:!1}),d=Object(s.a)(m,2),_=d[0],h=d[1],v=r.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),b=Object(s.a)(v,2),E=b[0],g=b[1],C=function(e){u({value:e.name,errorMessage:"",isValid:!0}),h({value:e.about,errorMessage:"",isValid:!0})};return r.a.useEffect((function(){C(o)}),[o]),r.a.createElement(p,{name:"profile",formTitle:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitButtonTitle:E,isOpen:a,onClose:function(){t(),C(o)},onSubmit:function(e){e.preventDefault(),g("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),n({name:c.value,about:_.value}).finally((function(){g("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},isSubmitDisabled:!c.isValid||!_.isValid},r.a.createElement("input",{className:"form__input",type:"text",name:"newProfileFullName",placeholder:"\u041f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:c.value,onChange:function(e){u({value:e.target.value,errorMessage:e.target.validationMessage,isValid:!e.target.validationMessage})}}),r.a.createElement("span",{className:"form__error",id:"newProfileFullName-error"},c.errorMessage),r.a.createElement("input",{className:"form__input",type:"text",name:"newProfileBio",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",value:_.value,onChange:function(e){h({value:e.target.value,errorMessage:e.target.validationMessage,isValid:!e.target.validationMessage})}}),r.a.createElement("span",{className:"form__error",id:"newProfileBio-error"},_.errorMessage))};var E=function(e){var a=e.isOpen,t=e.onClose,n=e.onUpdateAvatar,o=r.a.useRef(),i=r.a.useState({errorMessage:"",isValid:!1}),l=Object(s.a)(i,2),c=l[0],u=l[1],m=r.a.useState("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d=Object(s.a)(m,2),f=d[0],_=d[1],h=function(){o.current.value="",u({errorMessage:"",isValid:!1})};return r.a.createElement(p,{name:"avatar",formTitle:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitButtonTitle:f,isOpen:a,onClose:function(){t(),h()},onSubmit:function(e){e.preventDefault(),_("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),n(o.current.value).finally((function(){_("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),h()}))},isSubmitDisabled:!c.isValid},r.a.createElement("input",{className:"form__input",type:"url",name:"newAvatarLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,ref:o,onChange:function(){u({errorMessage:o.current.validationMessage,isValid:!o.current.validationMessage})}}),r.a.createElement("span",{className:"form__error",id:"newAvatarLink-error"},c.errorMessage))};var g=function(e){var a=e.isOpen,t=e.onClose,n=e.onAddPlace,o=r.a.useState({value:"",errorMessage:"",isValid:!1}),i=Object(s.a)(o,2),l=i[0],c=i[1],u=r.a.useState({value:"",errorMessage:"",isValid:!1}),m=Object(s.a)(u,2),d=m[0],f=m[1],_=r.a.useState("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),h=Object(s.a)(_,2),v=h[0],b=h[1],E=function(){c({value:"",errorMessage:"",isValid:!1}),f({value:"",errorMessage:"",isValid:!1})};return r.a.createElement(p,{name:"place",formTitle:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitButtonTitle:v,isOpen:a,onClose:function(){t(),E()},onSubmit:function(e){e.preventDefault(),b("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),n({name:l.value,link:d.value}).finally((function(){b("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),E()}))},isSubmitDisabled:!l.isValid||!d.isValid},r.a.createElement("input",{className:"form__input",type:"text",name:"newPlaceCaption",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"30",value:l.value,onChange:function(e){c({value:e.target.value,errorMessage:e.target.validationMessage,isValid:!e.target.validationMessage})}}),r.a.createElement("span",{className:"form__error",id:"newPlaceCaption-error"},l.errorMessage),r.a.createElement("input",{className:"form__input",type:"url",name:"newPlaceLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:d.value,onChange:function(e){f({value:e.target.value,errorMessage:e.target.validationMessage,isValid:!e.target.validationMessage})}}),r.a.createElement("span",{className:"form__error",id:"newPlaceLink-error"},d.errorMessage))};var C=function(e){var a=e.isOpen,t=e.onClose,n=e.onDeleteConfirmation,o=e.cardId;return r.a.createElement(p,{name:"confirm",formTitle:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitButtonTitle:"\u0414\u0430",isOpen:a,onClose:t,onSubmit:function(e){e.preventDefault(),n(o)}})};var k=function(e){var a=e.name,t=e.link,n=e.isOpen,o=e.onClose;return r.a.createElement("div",{className:"modal modal_for_photo ".concat(n?"modal_opened":"")},r.a.createElement("div",{className:"modal__content"},r.a.createElement("figure",{className:"modal__full-photo-view"},r.a.createElement("img",{className:"modal__full-photo",src:t,alt:a}),r.a.createElement("figcaption",{className:"modal__full-photo-caption"},a)),r.a.createElement("button",{className:"modal__close-button",type:"button",onClick:o})))},N=t(7),O=t(8),y=new(function(){function e(a){Object(N.a)(this,e),this._baseUrl=a.baseUrl,this._headers=a.headers}return Object(O.a)(e,[{key:"_onError",value:function(e){return e.ok?e.json():Promise.reject(new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status," ").concat(e.statusText)))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._onError)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._onError)}},{key:"editProfile",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._onError)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._onError)}},{key:"saveCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._onError)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onError)}},{key:"likeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._onError)}},{key:"dislikeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onError)}},{key:"changeLikeCardStatus",value:function(e,a){return a?this.dislikeCard(e):this.likeCard(e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-15",headers:{authorization:"7e5ed350-7573-4b9b-967c-f139542c3d10","Content-Type":"application/json"}});var S=function(){var e=r.a.useState({name:"",about:"",avatar:"#"}),a=Object(s.a)(e,2),t=a[0],n=a[1],o=r.a.useState([]),i=Object(s.a)(o,2),c=i[0],u=i[1],_=r.a.useState(!1),p=Object(s.a)(_,2),N=p[0],O=p[1],S=r.a.useState(!1),M=Object(s.a)(S,2),j=M[0],P=M[1],w=r.a.useState(!1),V=Object(s.a)(w,2),T=V[0],U=V[1],L=r.a.useState(!1),D=Object(s.a)(L,2),x=D[0],A=D[1],B=r.a.useState(!1),I=Object(s.a)(B,2),q=I[0],J=I[1],F=r.a.useState({}),G=Object(s.a)(F,2),H=G[0],R=G[1],z=r.a.useState(""),K=Object(s.a)(z,2),Q=K[0],W=K[1],X=r.a.useState(!0),Y=Object(s.a)(X,2),Z=Y[0],$=Y[1],ee=function(){P(!1),U(!1),A(!1),J(!1),O(!1)},ae=function(e){n({name:e.name,about:e.about,avatar:e.avatar,_id:e._id})};return r.a.useEffect((function(){Promise.all([y.getUserInfo(),y.getInitialCards()]).then((function(e){var a=e[0],t=e[1].map((function(e){return{_id:e._id,name:e.name,link:e.link,likes:e.likes,owner:e.owner}}));ae(a),u(t),$(!1)})).catch((function(e){return alert(e)}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(f.Provider,{value:t},r.a.createElement("div",{className:"page__container"},r.a.createElement(m,null),Z?r.a.createElement(d,null):r.a.createElement(h,{onEditProfile:function(){P(!0)},onAddPlace:function(){U(!0)},onEditAvatar:function(){A(!0)},cards:c,onCardClick:function(e){var a=e.name,t=e.link;R({name:a,link:t}),J(!0)},onCardLike:function(e,a){var n=e.some((function(e){return e._id===t._id}));y.changeLikeCardStatus(a,n).then((function(e){var t=c.map((function(t){return t._id===a?e:t}));u(t)})).catch((function(e){return alert(e)}))},onCardDelete:function(e){O(!0),W(e)}}),r.a.createElement(v,null)),r.a.createElement(b,{isOpen:j,onClose:ee,onUpdateUser:function(e){return y.editProfile(e).then((function(e){ae(e),ee()})).catch((function(e){return alert(e)}))}}),r.a.createElement(g,{isOpen:T,onClose:ee,onAddPlace:function(e){return y.saveCard(e).then((function(e){var a={_id:e._id,name:e.name,link:e.link,likes:e.likes,owner:e.owner};u([a].concat(Object(l.a)(c))),ee()})).catch((function(e){return alert(e)}))}}),r.a.createElement(E,{isOpen:x,onClose:ee,onUpdateAvatar:function(e){return y.changeAvatar(e).then((function(e){ae(e),ee()})).catch((function(e){return alert(e)}))}}),r.a.createElement(C,{isOpen:N,onClose:ee,onDeleteConfirmation:function(e){y.deleteCard(e).then((function(){var a=c.filter((function(a){return a._id!==e}));u(a),ee()})).catch((function(e){return alert(e)}))},cardId:Q}),r.a.createElement(k,Object.assign({isOpen:q,onClose:ee},H))))};i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))},6:function(e,a,t){e.exports=t.p+"static/media/logo_color_white.2b1f7ee5.svg"}},[[10,1,2]]]);
//# sourceMappingURL=main.b2f1066e.chunk.js.map